<?xml version="1.0" encoding="UTF-8"?>
<httpServerConfig>
  <serverName>$HOSTNAME</serverName>
  <user>nobody</user>
  <group>nobody</group>
  <priority>0</priority>
  <chrootPath>/</chrootPath>
  <enableChroot>0</enableChroot>
  <inMemBufSize>120M</inMemBufSize>
  <swappingDir>/tmp/lshttpd/swap</swappingDir>
  <autoFix503>1</autoFix503>
  <loadApacheConf>1</loadApacheConf>
  <autoReloadApacheConf>0</autoReloadApacheConf>
  <apacheConfFile>/usr/local/lsws/conf/httpd.conf</apacheConfFile>
  <apachePortOffset>0</apachePortOffset>
  <apacheIpOffset>0</apacheIpOffset>
  <phpSuExec>1</phpSuExec>
  <phpSuExecMaxConn>5</phpSuExecMaxConn>
  <mime>$SERVER_ROOT/conf/mime.properties</mime>
  <showVersionNumber>0</showVersionNumber>
  <autoUpdateInterval>86400</autoUpdateInterval>
  <autoUpdateDownloadPkg>1</autoUpdateDownloadPkg>
  <adminEmails>usman@cyberpersons.com</adminEmails>
  <adminRoot>$SERVER_ROOT/admin/</adminRoot>
  <logging>
    <log>
      <fileName>$SERVER_ROOT/logs/error.log</fileName>
      <logLevel>DEBUG</logLevel>
      <debugLevel>0</debugLevel>
      <rollingSize>10M</rollingSize>
      <enableStderrLog>1</enableStderrLog>
      <enableAioLog>1</enableAioLog>
    </log>
    <accessLog>
      <fileName>$SERVER_ROOT/logs/access.log</fileName>
      <rollingSize>10M</rollingSize>
      <keepDays>30</keepDays>
      <compressArchive>0</compressArchive>
    </accessLog>
  </logging>
  <indexFiles>index.html, index.php</indexFiles>
  <htAccess>
    <allowOverride>0</allowOverride>
    <accessFileName>.htaccess</accessFileName>
  </htAccess>
  <expires>
    <enableExpires>1</enableExpires>
    <expiresByType>image/*=A604800, text/css=A604800, application/x-javascript=A604800, application/javascript=A604800</expiresByType>
  </expires>
  <tuning>
    <eventDispatcher>best</eventDispatcher>
    <maxConnections>2000</maxConnections>
    <maxSSLConnections>200</maxSSLConnections>
    <connTimeout>300</connTimeout>
    <maxKeepAliveReq>1000</maxKeepAliveReq>
    <smartKeepAlive>0</smartKeepAlive>
    <keepAliveTimeout>5</keepAliveTimeout>
    <sndBufSize>0</sndBufSize>
    <rcvBufSize>0</rcvBufSize>
    <maxReqURLLen>8192</maxReqURLLen>
    <maxReqHeaderSize>16380</maxReqHeaderSize>
    <maxReqBodySize>500M</maxReqBodySize>
    <maxDynRespHeaderSize>8K</maxDynRespHeaderSize>
    <maxDynRespSize>500M</maxDynRespSize>
    <maxCachedFileSize>4096</maxCachedFileSize>
    <totalInMemCacheSize>20M</totalInMemCacheSize>
    <maxMMapFileSize>256K</maxMMapFileSize>
    <totalMMapCacheSize>40M</totalMMapCacheSize>
    <useSendfile>1</useSendfile>
    <useAIO>1</useAIO>
    <AIOBlockSize>4</AIOBlockSize>
    <enableGzipCompress>1</enableGzipCompress>
    <enableDynGzipCompress>1</enableDynGzipCompress>
    <gzipCompressLevel>1</gzipCompressLevel>
    <compressibleTypes>text/*,application/x-javascript,application/javascript,application/xml, image/svg+xml</compressibleTypes>
    <gzipAutoUpdateStatic>1</gzipAutoUpdateStatic>
    <gzipStaticCompressLevel>6</gzipStaticCompressLevel>
    <gzipMaxFileSize>1M</gzipMaxFileSize>
    <gzipMinFileSize>300</gzipMinFileSize>
    <SSLCryptoDevice>null</SSLCryptoDevice>
  </tuning>
  <quic>
    <quicEnable>1</quicEnable>
  </quic>
  <security>
    <fileAccessControl>
      <followSymbolLink>1</followSymbolLink>
      <checkSymbolLink>0</checkSymbolLink>
      <requiredPermissionMask>000</requiredPermissionMask>
      <restrictedPermissionMask>000</restrictedPermissionMask>
    </fileAccessControl>
    <perClientConnLimit>
      <staticReqPerSec>0</staticReqPerSec>
      <dynReqPerSec>0</dynReqPerSec>
      <outBandwidth>0</outBandwidth>
      <inBandwidth>0</inBandwidth>
      <softLimit>10000</softLimit>
      <hardLimit>10000</hardLimit>
      <gracePeriod>15</gracePeriod>
      <banPeriod>300</banPeriod>
    </perClientConnLimit>
    <CGIRLimit>
      <maxCGIInstances>200</maxCGIInstances>
      <minUID>11</minUID>
      <minGID>10</minGID>
      <priority>0</priority>
      <CPUSoftLimit>300</CPUSoftLimit>
      <CPUHardLimit>600</CPUHardLimit>
      <memSoftLimit>1450M</memSoftLimit>
      <memHardLimit>1500M</memHardLimit>
      <procSoftLimit>1400</procSoftLimit>
      <procHardLimit>1450</procHardLimit>
    </CGIRLimit>
    <censorshipControl>
      <enableCensorship>0</enableCensorship>
      <logLevel>0</logLevel>
      <defaultAction>deny,log,status:403</defaultAction>
      <scanPOST>1</scanPOST>
      <uploadTmpDir>/tmp</uploadTmpDir>
      <secAuditLog>$SERVER_ROOT/logs/security_audit.log</secAuditLog>
    </censorshipControl>
    <censorshipRuleSet>
      <name>XSS attack</name>
      <ruleSetAction>log,deny,status:403,msg:'XSS attack'</ruleSetAction>
      <enabled>1</enabled>
      <ruleSet>SecFilterSelective ARGS &quot;(alert|expression|eval|url)[[:space:]]*\(&quot;
SecFilterSelective ARGS &quot;(&amp;\{.+\}|(&amp;#[[0-9a-fA-F]]|\x5cx[0-9a-fA-F]){2})&quot;

SecFilterSelective ARGS &quot;((javascript|vbscript):|style[[:space:]]*=)&quot;
SecFilterSelective ARGS &quot;(fromCharCode|http-equiv|&lt;.+&gt;|innerHTML|dynsrc|--&gt;)&quot;
SecFilterSelective ARGS &quot;document\.(body|cookie|location|write)&quot;

SecFilterSelective ARGS_VALUES &quot;jsessionid|phpsessid|onReadyStateChange|xmlHttp&quot;

SecFilterSelective ARGS &quot;&lt;(applet|div|embed|iframe|img|meta|object|script|textarea)&quot;

# JavaScript event handlers
SecFilterSelective ARGS &quot;on(Abort|Blur|Click|DblClick|DragDrop|Error|Focus|KeyUp|KeyDown|KeyPrerss|Load|Mouse(Down|Out|Over|Up)|Move|Reset|Resize|Select|Submit|Unload)&quot;</ruleSet>
    </censorshipRuleSet>
    <censorshipRuleSet>
      <name>SQL injection</name>
      <ruleSetAction>log,pass,msg:'SQL Injection attack'</ruleSetAction>
      <enabled>1</enabled>
      <ruleSet>#SQL generic
SecFilterSelective ARGS &quot;drop[[:space:]]+(database|table|column|procedure)&quot;
SecFilterSelective ARGS &quot;delete[[:space:]]+from|create[[:space:]]+table|update.+set.+=|insert[[:space:]]+into.+values&quot;
SecFilterSelective ARGS &quot;select.+from|bulk[[:space:]]+insert|union.+select|alter[[:space:]]+table&quot;
SecFilterSelective ARGS &quot;or.+1[[:space:]]*=[[:space:]]1|or 1=1--'|'.+--&quot;

SecFilterSelective ARGS &quot;into[[:space:]]+outfile|load[[:space:]]+data|/\*.+\*/&quot;</ruleSet>
    </censorshipRuleSet>
    <accessDenyDir>
      <dir>/</dir>
      <dir>/etc/*</dir>
      <dir>/dev/*</dir>
      <dir>$SERVER_ROOT/conf/*</dir>
      <dir>$SERVER_ROOT/admin/conf/*</dir>
    </accessDenyDir>
    <accessControl>
      <allow>ALL</allow>
    </accessControl>
  </security>
  <extProcessorList>
    <extProcessor>
      <type>lsapi</type>
      <name>lsphp5</name>
      <address>uds://tmp/lshttpd/lsphp5.sock</address>
      <maxConns>35</maxConns>
      <env>PHP_LSAPI_CHILDREN=35</env>
      <initTimeout>60</initTimeout>
      <retryTimeout>0</retryTimeout>
      <persistConn>1</persistConn>
      <respBuffer>0</respBuffer>
      <autoStart>3</autoStart>
      <path>$SERVER_ROOT/fcgi-bin/lsphp5</path>
      <backlog>100</backlog>
      <instances>1</instances>
      <priority>0</priority>
      <memSoftLimit>2047M</memSoftLimit>
      <memHardLimit>2047M</memHardLimit>
      <procSoftLimit>400</procSoftLimit>
      <procHardLimit>500</procHardLimit>
    </extProcessor>
	<extProcessor>
      <type>lsapi</type>
      <name>lsphp53</name>
      <address>uds://tmp/lshttpd/lsphp53.sock</address>
      <maxConns>35</maxConns>
      <env>PHP_LSAPI_CHILDREN=35</env>
      <initTimeout>60</initTimeout>
      <retryTimeout>0</retryTimeout>
      <persistConn>1</persistConn>
      <respBuffer>0</respBuffer>
      <autoStart>3</autoStart>
      <path>$SERVER_ROOT/lsphp53/bin/lsphp</path>
      <backlog>100</backlog>
      <instances>1</instances>
      <priority>0</priority>
      <memSoftLimit>2047M</memSoftLimit>
      <memHardLimit>2047M</memHardLimit>
      <procSoftLimit>400</procSoftLimit>
      <procHardLimit>500</procHardLimit>
    </extProcessor>
	<extProcessor>
      <type>lsapi</type>
      <name>lsphp54</name>
      <address>uds://tmp/lshttpd/lsphp54.sock</address>
      <maxConns>35</maxConns>
      <env>PHP_LSAPI_CHILDREN=35</env>
      <initTimeout>60</initTimeout>
      <retryTimeout>0</retryTimeout>
      <persistConn>1</persistConn>
      <respBuffer>0</respBuffer>
      <autoStart>3</autoStart>
      <path>$SERVER_ROOT/lsphp54/bin/lsphp</path>
      <backlog>100</backlog>
      <instances>1</instances>
      <priority>0</priority>
      <memSoftLimit>2047M</memSoftLimit>
      <memHardLimit>2047M</memHardLimit>
      <procSoftLimit>400</procSoftLimit>
      <procHardLimit>500</procHardLimit>
    </extProcessor> 
	<extProcessor>
      <type>lsapi</type>
      <name>lsphp55</name>
      <address>uds://tmp/lshttpd/lsphp55.sock</address>
      <maxConns>35</maxConns>
      <env>PHP_LSAPI_CHILDREN=35</env>
      <initTimeout>60</initTimeout>
      <retryTimeout>0</retryTimeout>
      <persistConn>1</persistConn>
      <respBuffer>0</respBuffer>
      <autoStart>3</autoStart>
      <path>$SERVER_ROOT/lsphp55/bin/lsphp</path>
      <backlog>100</backlog>
      <instances>1</instances>
      <priority>0</priority>
      <memSoftLimit>2047M</memSoftLimit>
      <memHardLimit>2047M</memHardLimit>
      <procSoftLimit>400</procSoftLimit>
      <procHardLimit>500</procHardLimit>
    </extProcessor> 
	<extProcessor>
      <type>lsapi</type>
      <name>lsphp56</name>
      <address>uds://tmp/lshttpd/lsphp56.sock</address>
      <maxConns>35</maxConns>
      <env>PHP_LSAPI_CHILDREN=35</env>
      <initTimeout>60</initTimeout>
      <retryTimeout>0</retryTimeout>
      <persistConn>1</persistConn>
      <respBuffer>0</respBuffer>
      <autoStart>3</autoStart>
      <path>$SERVER_ROOT/lsphp56/bin/lsphp</path>
      <backlog>100</backlog>
      <instances>1</instances>
      <priority>0</priority>
      <memSoftLimit>2047M</memSoftLimit>
      <memHardLimit>2047M</memHardLimit>
      <procSoftLimit>400</procSoftLimit>
      <procHardLimit>500</procHardLimit>
    </extProcessor> 
    <extProcessor>
      <type>lsapi</type>
      <name>lsphp70</name>
      <address>uds://tmp/lshttpd/lsphp70.sock</address>
      <maxConns>35</maxConns>
      <env>PHP_LSAPI_CHILDREN=35</env>
      <initTimeout>60</initTimeout>
      <retryTimeout>0</retryTimeout>
      <persistConn>1</persistConn>
      <respBuffer>0</respBuffer>
      <autoStart>3</autoStart>
      <path>$SERVER_ROOT/lsphp70/bin/lsphp</path>
      <backlog>100</backlog>
      <instances>1</instances>
      <priority>0</priority>
      <memSoftLimit>2047M</memSoftLimit>
      <memHardLimit>2047M</memHardLimit>
      <procSoftLimit>400</procSoftLimit>
      <procHardLimit>500</procHardLimit>
    </extProcessor>
	<extProcessor>
      <type>lsapi</type>
      <name>lsphp71</name>
      <address>uds://tmp/lshttpd/lsphp71.sock</address>
      <maxConns>35</maxConns>
      <env>PHP_LSAPI_CHILDREN=35</env>
      <initTimeout>60</initTimeout>
      <retryTimeout>0</retryTimeout>
      <persistConn>1</persistConn>
      <respBuffer>0</respBuffer>
      <autoStart>3</autoStart>
      <path>$SERVER_ROOT/lsphp71/bin/lsphp</path>
      <backlog>100</backlog>
      <instances>1</instances>
      <priority>0</priority>
      <memSoftLimit>2047M</memSoftLimit>
      <memHardLimit>2047M</memHardLimit>
      <procSoftLimit>400</procSoftLimit>
      <procHardLimit>500</procHardLimit>
    </extProcessor>
	<extProcessor>
      <type>lsapi</type>
      <name>lsphp72</name>
      <address>uds://tmp/lshttpd/lsphp72.sock</address>
      <maxConns>35</maxConns>
      <env>PHP_LSAPI_CHILDREN=35</env>
      <initTimeout>60</initTimeout>
      <retryTimeout>0</retryTimeout>
      <persistConn>1</persistConn>
      <respBuffer>0</respBuffer>
      <autoStart>3</autoStart>
      <path>$SERVER_ROOT/lsphp72/bin/lsphp</path>
      <backlog>100</backlog>
      <instances>1</instances>
      <priority>0</priority>
      <memSoftLimit>2047M</memSoftLimit>
      <memHardLimit>2047M</memHardLimit>
      <procSoftLimit>400</procSoftLimit>
      <procHardLimit>500</procHardLimit>
    </extProcessor>
	<extProcessor>
      <type>lsapi</type>
      <name>lsphp73</name>
      <address>uds://tmp/lshttpd/lsphp73.sock</address>
      <maxConns>35</maxConns>
      <env>PHP_LSAPI_CHILDREN=35</env>
      <initTimeout>60</initTimeout>
      <retryTimeout>0</retryTimeout>
      <persistConn>1</persistConn>
      <respBuffer>0</respBuffer>
      <autoStart>3</autoStart>
      <path>$SERVER_ROOT/lsphp73/bin/lsphp</path>
      <backlog>100</backlog>
      <instances>1</instances>
      <priority>0</priority>
      <memSoftLimit>2047M</memSoftLimit>
      <memHardLimit>2047M</memHardLimit>
      <procSoftLimit>400</procSoftLimit>
      <procHardLimit>500</procHardLimit>
    </extProcessor>  
  </extProcessorList>
  <scriptHandlerList>
    <scriptHandler>
      <suffix>php</suffix>
      <type>lsapi</type>
      <handler>lsphp5</handler>
    </scriptHandler>
    <scriptHandler>
      <suffix>php5</suffix>
      <type>lsapi</type>
      <handler>lsphp5</handler>
    </scriptHandler>
	<scriptHandler>
      <suffix>php53</suffix>
      <type>lsapi</type>
      <handler>lsphp53</handler>
    </scriptHandler> 
	<scriptHandler>
      <suffix>php54</suffix>
      <type>lsapi</type>
      <handler>lsphp54</handler>
    </scriptHandler> 
	<scriptHandler>
      <suffix>php55</suffix>
      <type>lsapi</type>
      <handler>lsphp55</handler>
    </scriptHandler> 
	<scriptHandler>
      <suffix>php56</suffix>
      <type>lsapi</type>
      <handler>lsphp56</handler>
    </scriptHandler>  
    <scriptHandler>
      <suffix>php70</suffix>
      <type>lsapi</type>
      <handler>lsphp70</handler>
    </scriptHandler>
	<scriptHandler>
      <suffix>php71</suffix>
      <type>lsapi</type>
      <handler>lsphp71</handler>
    </scriptHandler>
	<scriptHandler>
      <suffix>php72</suffix>
      <type>lsapi</type>
      <handler>lsphp72</handler>
    </scriptHandler>
	<scriptHandler>
      <suffix>php73</suffix>
      <type>lsapi</type>
      <handler>lsphp73</handler>
    </scriptHandler>
  </scriptHandlerList>
  <railsDefaults>
    <railsEnv>1</railsEnv>
    <maxConns>5</maxConns>
    <env>LSAPI_MAX_IDLE=60</env>
    <initTimeout>180</initTimeout>
    <retryTimeout>0</retryTimeout>
    <pcKeepAliveTimeout>60</pcKeepAliveTimeout>
    <respBuffer>0</respBuffer>
    <backlog>50</backlog>
    <runOnStartUp>1</runOnStartUp>
    <priority>3</priority>
    <memSoftLimit>2047M</memSoftLimit>
    <memHardLimit>2047M</memHardLimit>
    <procSoftLimit>400</procSoftLimit>
    <procHardLimit>500</procHardLimit>
  </railsDefaults>
</httpServerConfig>
